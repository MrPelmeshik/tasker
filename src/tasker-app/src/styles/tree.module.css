.tree {
  height: 100%;
  display: flex;
  flex-direction: column;
  box-sizing: border-box;
}

.widgetContent {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  display: flex;
  flex-direction: column;
  gap: var(--tree-row-spacing);
  box-sizing: border-box;
}

.areaSection {
  position: relative;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: var(--tree-row-spacing);
  box-sizing: border-box;
}

/** Wrapper для droppable-зоны области: карточка + дочерние папки/задачи */
.areaBlock {
  display: flex;
  flex-direction: column;
  gap: var(--tree-row-spacing);
  box-sizing: border-box;
}

/** Wrapper для droppable-зоны папки: карточка + дочерние подпапки/задачи */
.folderBlock {
  display: flex;
  flex-direction: column;
  gap: var(--tree-row-spacing);
  box-sizing: border-box;
}

/** Строка действий над деревом (создать область, развернуть/свернуть) */
.treeTopActions {
  display: flex;
  align-items: center;
  gap: var(--tree-row-gap);
  margin-bottom: var(--space-8);
}

/** Иконные кнопки в строке treeTopActions — единый размер (квадрат) */
.treeTopActionButton {
  min-width: var(--size-28);
  min-height: var(--size-28);
  padding: var(--space-4) !important;
}

/** Обёртка блока фильтров: иконка + кнопки статусов (высота как у treeTopActionButton) */
.treeStatusFiltersBlock {
  display: flex;
  align-items: center;
  gap: var(--tree-row-gap);
  min-height: var(--size-28);
  padding: 0 var(--space-6);
  border-radius: var(--radius-xs);
  border: var(--border-1) solid rgb(var(--white) / 0.08);
  background: var(--glass-bg-1);
}

/** Иконка в блоке фильтров — цвет как у treeActionButton */
.treeStatusFiltersBlockIcon {
  color: var(--glass-icon-default);
  display: flex;
  align-items: center;
  justify-content: center;
}

/** Блок кнопок фильтрации по статусам */
.treeStatusFilters {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

/** Кнопка статуса в фильтре (компактный бейдж) */
.treeStatusFilterBtn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-2);
  border: none;
  border-radius: var(--radius-2xs);
  background: transparent;
  cursor: pointer;
  transition: opacity var(--transition-fast);
}

.treeStatusFilterBtn:hover {
  background: var(--glass-hover-bg);
}

.treeStatusFilterBtnDisabled {
  opacity: 0.4;
}

.treeStatusFilterBtnDisabled:hover {
  opacity: 0.6;
}

/** Селект сортировки в тулбаре — компактная ширина */
.treeSortSelect {
  min-width: var(--tree-sort-select-min-width);
  max-width: var(--tree-sort-select-max-width);
}

.areaCard {
  position: relative;
  background: transparent;
  border: none;
  border-radius: var(--radius-xs);
  padding: var(--tree-row-padding-y) var(--space-2);
  cursor: pointer;
  box-sizing: border-box;
  box-shadow: none;
  overflow: hidden;
  min-width: 0;
  display: flex;
  align-items: center;
}

.folderCard,
.taskCard {
  position: relative;
  background: transparent;
  border: none;
  border-radius: var(--radius-xs);
  padding: var(--tree-row-padding-y) var(--space-2);
  box-sizing: border-box;
  box-shadow: none;
  overflow: hidden;
  min-width: 0;
  display: flex;
  align-items: center;
}

.areaItem {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  box-sizing: border-box;
}

.areaCard {
  width: 100%;
  min-width: 0;
  gap: var(--tree-row-gap);
  flex-direction: row;
  flex-wrap: nowrap;
  align-items: center;
  justify-content: space-between;
  transition: background var(--transition-normal);
  animation: fadeInUp var(--transition-slow) ease-out;
}

.folderCard,
.taskCard {
  flex: 1;
  min-width: 0;
  max-width: 100%;
  width: 100%;
  gap: var(--tree-row-gap);
  flex-direction: row;
  flex-wrap: nowrap;
  align-items: center;
  justify-content: space-between;
  transition: background var(--transition-fast);
  cursor: grab;
  touch-action: none;
}

.folderCard:active,
.taskCard:active {
  cursor: grabbing;
}

.taskCard:hover {
  background: var(--glass-hover-bg);
  box-shadow: none;
}

.areaCard:hover,
.folderCard:hover {
  background: var(--glass-hover-bg);
}

.areaCard[data-custom-color],
.folderCard[data-custom-color],
.taskCard[data-custom-color] {
  --custom-color: var(--card-custom-color);
  --custom-color-rgb: var(--card-custom-color-rgb);
}

.areaCard[data-custom-color]:hover,
.folderCard[data-custom-color]:hover,
.taskCard[data-custom-color]:hover {
  background: rgba(var(--custom-color-rgb), 0.06);
}

.treeRowMain {
  display: flex;
  align-items: center;
  gap: var(--tree-row-gap);
  min-width: var(--tree-row-main-min-width);
  overflow: hidden;
  order: -1;
}

.areaCard .treeRowMain,
.folderCard .treeRowMain,
.taskCard .treeRowMain {
  flex: 1 1 0;
}

.foldersSection {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: var(--tree-row-spacing);
  box-sizing: border-box;
  animation: slideDown var(--transition-normal) ease-out;
}

.folderItem {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  box-sizing: border-box;
}

.tasksSection {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: var(--tree-row-spacing);
  box-sizing: border-box;
  animation: slideDown var(--transition-normal) ease-out;
}

.taskItem {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  box-sizing: border-box;
}

.areaCard .treeRowActions,
.folderCard .treeRowActions,
.taskCard .treeRowActions {
  display: flex;
  align-items: center;
  justify-content: center;
  max-width: 0;
  overflow: hidden;
  opacity: 0;
  pointer-events: none;
  transition: max-width var(--transition-fast), opacity var(--transition-fast);
  flex-shrink: 0;
}

.areaCard:hover .treeRowActions,
.folderCard:hover .treeRowActions,
.taskCard:hover .treeRowActions {
  max-width: var(--tree-actions-max-width);
  opacity: 1;
  pointer-events: auto;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(calc(-1 * var(--space-10)));
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(var(--space-20));
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.areaCard.isOverValid,
.folderCard.isOverValid {
  border-color: var(--dnd-valid-border);
  background: var(--dnd-valid-bg);
  box-shadow: var(--dnd-valid-shadow);
}

.areaCard.isOverInvalid,
.folderCard.isOverInvalid {
  border-color: var(--dnd-invalid-border);
  background: var(--dnd-invalid-bg);
  opacity: var(--dnd-invalid-opacity);
}

.folderItem.isDragging,
.taskItem.isDragging {
  opacity: var(--dnd-dragging-opacity);
}

.folderItem.isDragging .folderCard,
.taskItem.isDragging .taskCard {
  outline: var(--border-1) dashed var(--dnd-outline-color);
}

/** Стили кнопок действий дерева: стеклянный эффект от GlassButton subtle + цвет иконок */
.treeActionButton {
  color: var(--glass-icon-default);
  transition: color var(--transition-fast), background var(--transition-fast), border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.treeActionButton:hover {
  color: var(--glass-icon-hover);
}

.treeRowActions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex-shrink: 0;
  order: 0;
}

.areaCard .treeRowActions,
.folderCard .treeRowActions,
.taskCard .treeRowActions {
  margin-left: auto;
}

.dragOverlayCard {
  padding: var(--space-4) var(--space-6);
  border-radius: var(--radius-2xs);
  background: var(--glass-gradient-bg);
  border: var(--border-1) solid var(--glass-border-4);
  box-shadow: var(--shadow-elev-3);
  cursor: grabbing;
  opacity: var(--dnd-overlay-opacity);
  min-width: var(--dnd-overlay-min-width);
  display: flex;
  align-items: center;
  gap: var(--tree-row-gap);
}

.dragHint {
  font-size: var(--font-12);
  color: var(--glass-text-muted);
}
